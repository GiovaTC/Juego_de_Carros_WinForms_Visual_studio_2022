# Juego_de_Carros_WinForms_Visual_studio_2022 :
# Juego de Carros (WinForms) — Visual Studio 2022 .

<img width="1536" height="1024" alt="image" src="https://github.com/user-attachments/assets/aba15347-bdea-42bb-b222-1e729a286cf7" />

> Proyecto ejemplo en C# (WinForms) que muestra una interfaz gráfica simple tipo arcade, controla un coche con el teclado, mantiene puntaje y registra cada partida en Oracle 19c .

---

## Qué incluye :

- `README.md` con instrucciones de instalación.
- `Program.cs` — arranque de la app.
- `Form1.cs` — código del formulario principal (interfaz, lógica del juego y registro en Oracle).
- SQL para crear la tabla `SCORES`.

---

## README (resumen rápido) :

1. Abrir Visual Studio 2022 .
2. Crear un nuevo proyecto **Windows Forms App** (.NET 6 o .NET Framework según preferencia). Recomendado: **.NET 6 (Windows)** .
3. Reemplazar `Program.cs` y `Form1.cs` por los archivos de este proyecto (pegar) .
4. Instalar paquete NuGet para Oracle:

- Si usas .NET 6: `Oracle.ManagedDataAccess.Core`
- Si usas .NET Framework: `Oracle.ManagedDataAccess`

En la Consola del Administrador de paquetes:

```
Install-Package Oracle.ManagedDataAccess.Core
```

5. Crear la tabla en Oracle 19c (ejecutar en SQL*Plus / SQL Developer) :

```sql
CREATE TABLE SCORES (
  ID NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
  PLAYER VARCHAR2(100),
  SCORE NUMBER,
  PLAYED_AT TIMESTAMP
);
```

6. Configurar la cadena de conexión en `Form1.cs` (buscar `// TODO:...`) .

7. Ejecutar el proyecto:

---

## Program.cs

```csharp
using System;
using System.Windows.Forms;

namespace JuegoCarros
{
    static class Program
    {
        [STAThread]
        static void Main()
        {
            Application.SetHighDpiMode(HighDpiMode.SystemAware);
            Application.EnableVisualStyles();
            Application.SetCompatibleTextRenderingDefault(false);
            Application.Run(new Form1());
        }
    }
}
```

---

## Form1.cs

```csharp
using System;
using System.Collections.Generic;
using System.Data;
using System.Drawing;
using System.Linq;
using System.Windows.Forms;
// Para Oracle
using Oracle.ManagedDataAccess.Client;

namespace JuegoCarros
{
    public class Form1 : Form
    {
        private Timer gameTimer;
        private PictureBox playerCar;
        private List<PictureBox> obstacles = new List<PictureBox>();
        private Random rnd = new Random();
        private int speed = 8;
        private int obstacleSpeed = 6;
        private int score = 0;
        private Label lblScore;
        private Button btnStart;
        private Button btnSave;
        private TextBox txtPlayer;

        // TODO: Cambia aquí tu cadena de conexión Oracle
        // Ejemplo EZCONNECT: "User Id=MYUSER;Password=MYPASS;Data Source=hostname:1521/ORCLPDB1"
        private string oracleConnectionString = "User Id=MYUSER;Password=MYPASS;Data Source=HOST:1521/SERVICE";

        public Form1()
        {
            InitializeComponent();
        }

        private void InitializeComponent()
        {
            this.Text = "Juego de Carros - VS2022 + Oracle 19c";
            this.ClientSize = new Size(400, 600);
            this.FormBorderStyle = FormBorderStyle.FixedSingle;
            this.MaximizeBox = false;

            lblScore = new Label() { Text = "Score: 0", Location = new Point(10, 10), AutoSize = true };
            this.Controls.Add(lblScore);

            txtPlayer = new TextBox() { Location = new Point(100, 8), Width = 180, Text = "Jugador1" };
            this.Controls.Add(txtPlayer);

            btnStart = new Button() { Text = "Iniciar", Location = new Point(290, 6), Width = 80 };
            btnStart.Click += BtnStart_Click;
            this.Controls.Add(btnStart);

            btnSave = new Button() { Text = "Guardar", Location = new Point(290, 40), Width = 80, Enabled = false };
            btnSave.Click += BtnSave_Click;
            this.Controls.Add(btnSave);

            playerCar = new PictureBox();
            playerCar.Size = new Size(40, 70);
            playerCar.BackColor = Color.Blue;
            playerCar.Location = new Point((this.ClientSize.Width - playerCar.Width) / 2, this.ClientSize.Height - playerCar.Height - 30);
            this.Controls.Add(playerCar);

            gameTimer = new Timer();
            gameTimer.Interval = 20; // ~50 FPS
            gameTimer.Tick += GameTimer_Tick;

            this.KeyDown += Form1_KeyDown;
            this.KeyUp += Form1_KeyUp;
        }

        private bool leftPressed = false;
        private bool rightPressed = false;

        private void Form1_KeyDown(object sender, KeyEventArgs e)
        {
            if (e.KeyCode == Keys.Left) leftPressed = true;
            if (e.KeyCode == Keys.Right) rightPressed = true;
        }

        private void Form1_KeyUp(object sender, KeyEventArgs e)
        {
            if (e.KeyCode == Keys.Left) leftPressed = false;
            if (e.KeyCode == Keys.Right) rightPressed = false;
        }

        private void BtnStart_Click(object sender, EventArgs e)
        {
            ResetGame();
            gameTimer.Start();
            btnSave.Enabled = false;
            btnStart.Enabled = false;
        }

        private void ResetGame()
        {
            // limpiar obstaculos
            foreach (var obs in obstacles) this.Controls.Remove(obs);
            obstacles.Clear();
            score = 0;
            lblScore.Text = "Score: 0";
            playerCar.Location = new Point((this.ClientSize.Width - playerCar.Width) / 2, this.ClientSize.Height - playerCar.Height - 30);
        }

        private int tickCounter = 0;

        private void GameTimer_Tick(object sender, EventArgs e)
        {
            tickCounter++;

            // mover jugador
            if (leftPressed) playerCar.Left = Math.Max(0, playerCar.Left - speed);
            if (rightPressed) playerCar.Left = Math.Min(this.ClientSize.Width - playerCar.Width, playerCar.Left + speed);

            // crear obstaculos cada cierta cantidad de ticks
            if (tickCounter % 30 == 0)
            {
                CreateObstacle();
            }

            // mover obstaculos
            for (int i = obstacles.Count - 1; i >= 0; i--)
            {
                var obs = obstacles[i];
                obs.Top += obstacleSpeed;
                if (obs.Top > this.ClientSize.Height)
                {
                    // pasado de pantalla -> quitar y sumar puntaje
                    this.Controls.Remove(obs);
                    obstacles.RemoveAt(i);
                    score += 10;
                    lblScore.Text = "Score: " + score;
                    continue;
                }

                // colisión
                if (obs.Bounds.IntersectsWith(playerCar.Bounds))
                {
                    GameOver();
                    return;
                }
            }

            // aumentar dificultad cada tantos puntos
            if (score > 0 && score % 100 == 0)
            {
                obstacleSpeed = 6 + (score / 100);
            }
        }

        private void CreateObstacle()
        {
            var width = rnd.Next(30, 80);
            var obs = new PictureBox();
            obs.Size = new Size(width, rnd.Next(20, 50));
            obs.BackColor = Color.Red;
            int x = rnd.Next(0, this.ClientSize.Width - obs.Width);
            obs.Location = new Point(x, -obs.Height);
            obstacles.Add(obs);
            this.Controls.Add(obs);
            obs.BringToFront();
            playerCar.BringToFront();
        }

        private void GameOver()
        {
            gameTimer.Stop();
            btnSave.Enabled = true;
            btnStart.Enabled = true;
            MessageBox.Show($"Juego terminado. Puntaje: {score}", "Game Over", MessageBoxButtons.OK, MessageBoxIcon.Information);
        }

        private void BtnSave_Click(object sender, EventArgs e)
        {
            SaveScoreToOracle(txtPlayer.Text, score);
        }

        private void SaveScoreToOracle(string player, int scoreValue)
        {
            try
            {
                using (var con = new OracleConnection(oracleConnectionString))
                {
                    con.Open();
                    using (var cmd = con.CreateCommand())
                    {
                        cmd.CommandText = "INSERT INTO SCORES (PLAYER, SCORE, PLAYED_AT) VALUES (:p, :s, SYSTIMESTAMP)";
                        cmd.Parameters.Add(new OracleParameter("p", OracleDbType.Varchar2) { Value = player });
                        cmd.Parameters.Add(new OracleParameter("s", OracleDbType.Int32) { Value = scoreValue });
                        int rows = cmd.ExecuteNonQuery();
                        if (rows > 0)
                        {
                            MessageBox.Show("Puntaje guardado en Oracle 19c.", "OK", MessageBoxButtons.OK, MessageBoxIcon.Information);
                            btnSave.Enabled = false;
                        }
                        else
                        {
                            MessageBox.Show("No se pudo guardar el puntaje.", "Error", MessageBoxButtons.OK, MessageBoxIcon.Error);
                        }
                    }
                }
            }
            catch (Exception ex)
            {
                MessageBox.Show("Error al guardar en Oracle: " + ex.Message, "Error", MessageBoxButtons.OK, MessageBoxIcon.Error);
            }
        }
    }
}
```

---

## Notas importantes y consejos :

- **Cadena de conexión:** pide a tu DBA los parámetros correctos o usa EZCONNECT `host:port/service`.
- **Puertos/Firewall:** si Oracle está en otra máquina, asegúrate que el puerto (1521 por defecto) esté abierto.
- **Oracle Client vs Managed:** `Oracle.ManagedDataAccess.Core` no requiere instalar Oracle Client.
- **Manejo de concurrencia y seguridad:** este ejemplo es educativo; para producción usa stored procedures o procedimientos más robustos y valida entradas.
- **Gráficos:** puedes reemplazar `PictureBox` con imágenes (`Image = ...`) o usar sprites para mejor apariencia.

---:.
